{% extends 'base.html' %}
{% block body %}
<main class="container">
  <h3>Admin – Manage Users</h3>

  {% if users %}
    <table class="table">
      <thead>
        <tr>
          <th>ID</th><th>Name</th><th>Email</th><th>Current Role</th><th>Dept</th><th>Update</th>
        </tr>
      </thead>
      <tbody>
      {% for u in users %}
        {% set form = forms[u.id] %}
        <tr>
          <td>{{ u.id }}</td>
          <td>{{ u.username }}</td>
          <td>{{ u.email }}</td>
          <td>{{ u.role.value }}</td>
          <td>{{ u.department or '—' }}</td>
          <td>
            <form method="POST" action="{{ url_for('journal.admin_users_update') }}">
              {{ form.hidden_tag() }}
              {{ form.user_id(value=u.id) }}
              {{ form.role(class_='input') }}
              {{ form.department(class_='input') }}
              {{ form.submit(class_='btn') }}
            </form>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No users found.</p>
  {% endif %}
</main>
{% endblock %}
